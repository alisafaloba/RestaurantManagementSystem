<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${order.id == null} ? 'Create Order' : 'Edit Order'"></title>

    <style>
        /* Einheitliches CSS-Design übernommen und angepasst */
        body { font-family: Arial, sans-serif; max-width: 550px; margin: 40px auto; padding: 10px; }
        h1 { text-align: center; margin-bottom: 25px; }
        form { display: flex; flex-direction: column; gap: 15px; background: #fafafa; padding: 20px; border-radius: 8px; border: 1px solid #ddd; }
        label { font-weight: bold; margin-bottom: 5px; display: block; }
        input, select { padding: 10px; border: 1px solid #ccc; border-radius: 6px; width: 100%; box-sizing: border-box; font-size: 14px; }
        /* Stil für Validierungsfehler */
        .error { color: red; font-size: 13px; }
        .btn-submit { background-color: #4CAF50; color: white; border: none; padding: 10px 16px; cursor: pointer; border-radius: 6px; font-size: 15px; }
        .btn-submit:hover { background-color: #45a049; }
        .back-link { text-align: center; display: inline-block; margin-top: 20px; color: #007bff; text-decoration: none; }
    </style>
</head>

<body>

<h1 th:text="${order.id == null} ? 'Create New Order' : 'Edit Order'"></h1>

<form th:action="${order.id == null} ? @{/order} : @{'/order/' + ${order.id} + '/update'}"
      th:object="${order}" method="post">

    <div>
        <label for="customer">Customer</label>
        <select id="customer" name="customerId" required>
            <option value="">-- Select Customer --</option>

            <option th:each="cust : ${customers}"
                    th:value="${cust.id}"
                    th:text="${cust.name}"
                    th:selected="${order.customer != null and order.customer.id == cust.id}">
            </option>
        </select>
        <div th:if="${#fields.hasErrors('customer')}" class="error" th:errors="*{customer}"></div>
    </div>

    <div>
        <label for="table">Table</label>
        <select id="table" name="tableId" required>
            <option value="">-- Select Table --</option>
            <option th:each="t : ${tables}"
                    th:value="${t.id}"
                    th:text="'Table ' + ${t.number}"
                    th:selected="${order.table != null and order.table.id == t.id}">
            </option>
        </select>
        <div th:if="${#fields.hasErrors('table')}" class="error" th:errors="*{table}"></div>
    </div>

    <div>
        <label for="status">Status</label>
        <select id="status" th:field="*{status}">
            <option th:each="s : ${statuses}" th:text="${s}" th:value="${s}"></option>
        </select>
        <div th:if="${#fields.hasErrors('status')}" class="error" th:errors="*{status}"></div>
    </div>

    <div>
        <label for="date">Order Date</label>
        <input type="datetime-local" id="date"
               th:value="${order.date != null ? #temporals.format(order.date, 'yyyy-MM-dd''T''HH:mm') : ''}"
               name="date" required>

        <div th:if="${#fields.hasErrors('date')}" class="error" th:errors="*{date}"></div>
    </div>

    <button type="submit" class="btn-submit" th:text="${order.id == null} ? 'Save Order' : 'Update Order'"></button>
</form>

<div style="text-align: center; margin-top: 20px;">
    <a class="back-link" th:href="@{/}" style="margin-right: 15px;">← Back to Home</a>
    <a class="back-link" th:href="@{/order}">← Back to Order List</a>
</div>

</body>
</html>